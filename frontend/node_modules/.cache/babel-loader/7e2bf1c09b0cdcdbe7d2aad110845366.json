{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nimport { Component, removeClass } from '@syncfusion/ej2-base';\nimport { EventHandler, isNullOrUndefined } from '@syncfusion/ej2-base';\n\nvar SignatureBase =\n/** @class */\nfunction (_super) {\n  __extends(SignatureBase, _super);\n\n  function SignatureBase() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n    /* minDistance(distance between the two point) was calaculated for smoothness.*/\n\n\n    _this.minDistance = 5;\n    _this.previous = 0;\n    /* interval handles for the smoothness in the mouse move event.*/\n\n    _this.interval = 30;\n    _this.timeout = null;\n    _this.isSignatureEmpty = true;\n    _this.backgroundLoaded = null;\n    _this.clearArray = [];\n    _this.isBlazor = false;\n    _this.isResponsive = false;\n    _this.imageEditorPointsColl = [];\n    return _this;\n  }\n  /**\n   * To Initialize the component rendering\n   *\n   * @private\n   * @param {HTMLCanvasElement} element - Specifies the canvas element.\n   * @param {BlazorDotnetObject} dotnetRef - Specifies for blazor client to server communication.\n   * @returns {void}\n   */\n\n\n  SignatureBase.prototype.initialize = function (element, dotnetRef) {\n    this.element = element;\n    this.canvasContext = this.element.getContext('2d');\n    this.canvasContext.canvas.tabIndex = 0;\n\n    if (dotnetRef) {\n      this.dotnetRef = dotnetRef;\n      this.isBlazor = true;\n\n      if (this.signatureValue) {\n        this.loadPersistedSignature();\n      }\n    }\n\n    this.setHTMLProperties();\n\n    if (isNullOrUndefined(this.signatureValue)) {\n      this.updateSnapCollection(true);\n    }\n\n    this.wireEvents();\n\n    if (!this.isBlazor) {\n      this.trigger('created', null);\n    }\n  };\n\n  SignatureBase.prototype.wireEvents = function () {\n    if (isNullOrUndefined(this.pointColl) && !this.isReadOnly && !this.disabled) {\n      EventHandler.add(this.canvasContext.canvas, 'mousedown touchstart', this.mouseDownHandler, this);\n      EventHandler.add(this.canvasContext.canvas, 'keydown', this.keyboardHandler, this);\n      window.addEventListener('resize', this.resizeHandler.bind(this));\n    } else if (this.pointColl) {\n      EventHandler.add(this.canvasContext.canvas, 'mousemove touchmove', this.mouseMoveHandler, this);\n      EventHandler.add(this.canvasContext.canvas, 'mouseup touchend', this.mouseUpHandler, this);\n      EventHandler.add(document, 'mouseup', this.mouseUpHandler, this);\n    }\n  };\n\n  SignatureBase.prototype.unwireEvents = function (type) {\n    if (type === 'mouseup' || type === 'touchend') {\n      EventHandler.remove(this.canvasContext.canvas, 'mousemove touchmove', this.mouseMoveHandler);\n      EventHandler.remove(this.canvasContext.canvas, 'mouseup touchend', this.mouseUpHandler);\n      EventHandler.remove(document, 'mouseup', this.mouseUpHandler);\n    } else {\n      EventHandler.remove(this.canvasContext.canvas, 'mousedown touchstart', this.mouseDownHandler);\n      EventHandler.remove(this.canvasContext.canvas, 'keydown', this.keyboardHandler);\n      window.removeEventListener('resize', this.resizeHandler);\n    }\n  };\n\n  SignatureBase.prototype.setHTMLProperties = function () {\n    if (this.element.height === 150 && this.element.width === 300) {\n      this.element.height = this.element.offsetHeight;\n      this.element.width = this.element.offsetWidth;\n      this.isResponsive = true;\n    }\n\n    this.canvasContext.scale(1, 1);\n    this.canvasContext.fillStyle = this.strokeColor;\n\n    if (this.backgroundImage) {\n      this.canvasContext.canvas.style.backgroundImage = 'url(' + this.backgroundImage + ')';\n      this.canvasContext.canvas.style.backgroundRepeat = 'no-repeat';\n    } else if (this.backgroundColor) {\n      this.canvasContext.canvas.style.backgroundColor = this.backgroundColor;\n    }\n  };\n\n  SignatureBase.prototype.mouseDownHandler = function (e, canvas, panStart, zoomState) {\n    if (e.buttons === 1 || e.buttons === 2 || e.type === 'touchstart') {\n      if (e.type === 'touchstart') {\n        e.preventDefault();\n        e.stopPropagation();\n      }\n\n      if (canvas) {\n        this.canvasContext = canvas.getContext('2d');\n        this.scale = zoomState;\n        this.panStart = panStart;\n      }\n\n      this.beginStroke(e);\n      this.wireEvents();\n    }\n  };\n\n  SignatureBase.prototype.mouseMoveHandler = function (e) {\n    if (e.buttons === 1 || e.buttons === 2 || e.type === 'touchmove') {\n      if (e.type === 'touchmove') {\n        e.preventDefault();\n        e.stopPropagation();\n      }\n\n      if (this.interval) {\n        this.updateStrokeWithThrottle(e);\n      } else {\n        this.updateStroke(e);\n      }\n    }\n  };\n\n  SignatureBase.prototype.mouseUpHandler = function (e) {\n    var args = {\n      actionName: 'strokeUpdate'\n    };\n\n    if (e.type === 'touchstart') {\n      e.preventDefault();\n      e.stopPropagation();\n    }\n\n    this.endDraw();\n    this.updateSnapCollection();\n    this.unwireEvents(e.type);\n\n    if (!this.isBlazor) {\n      this.trigger('change', args);\n    } else {\n      this.dotnetRef.invokeMethodAsync('TriggerEventAsync', 'mouseUp');\n    }\n\n    this.signatureValue = this.snapColl[this.incStep];\n  };\n\n  SignatureBase.prototype.keyboardHandler = function (e) {\n    var _this = this;\n\n    var args = {\n      fileName: 'Signature',\n      type: 'Png',\n      cancel: false\n    };\n\n    switch (e.key) {\n      case 'Delete':\n        this.clear();\n        break;\n\n      case e.ctrlKey && 's':\n        if (!this.isBlazor) {\n          this.trigger('beforeSave', args, function (observableSaveArgs) {\n            if (!args.cancel) {\n              _this.save(observableSaveArgs.type, observableSaveArgs.fileName);\n            }\n          });\n        } else {\n          this.dotnetRef.invokeMethodAsync('TriggerEventAsync', 'beforeSave');\n        }\n\n        e.preventDefault();\n        e.stopImmediatePropagation();\n        break;\n\n      case e.ctrlKey && 'z':\n        this.undo();\n        break;\n\n      case e.ctrlKey && 'y':\n        this.redo();\n        break;\n    }\n  };\n\n  SignatureBase.prototype.resizeHandler = function () {\n    // eslint-disable-next-line @typescript-eslint/no-this-alias\n    var proxy = this;\n\n    if (this.isResponsive) {\n      this.canvasContext.canvas.width = this.element.offsetWidth;\n      this.canvasContext.canvas.height = this.element.offsetHeight;\n      this.canvasContext.scale(1, 1);\n    }\n\n    var restoreImg = new Image();\n    restoreImg.src = this.snapColl[this.incStep];\n\n    restoreImg.onload = function () {\n      proxy.canvasContext.clearRect(0, 0, proxy.element.width, proxy.element.height);\n      proxy.canvasContext.drawImage(restoreImg, 0, 0, proxy.element.width, proxy.element.height);\n    };\n  };\n\n  SignatureBase.prototype.beginStroke = function (e) {\n    this.refresh();\n    this.updateStroke(e);\n  };\n\n  SignatureBase.prototype.updateStroke = function (e) {\n    var point = this.createPoint(e);\n    this.addPoint(point);\n  };\n\n  SignatureBase.prototype.updateStrokeWithThrottle = function (args) {\n    var now = Date.now();\n    var remaining = this.interval - (now - this.previous);\n    this.storedArgs = args;\n\n    if (remaining <= 0 || remaining > this.interval) {\n      if (this.timeout) {\n        clearTimeout(this.timeout);\n        this.timeout = null;\n      }\n\n      this.previous = now;\n      this.updateStroke(this.storedArgs);\n\n      if (!this.timeout) {\n        this.storedArgs = null;\n      }\n    } else if (!this.timeout) {\n      this.timeout = window.setTimeout(this.delay.bind(this), remaining);\n    }\n  };\n\n  SignatureBase.prototype.delay = function () {\n    this.previous = Date.now();\n    this.timeout = null;\n    this.updateStroke(this.storedArgs);\n\n    if (!this.timeout) {\n      this.storedArgs = null;\n    }\n  };\n\n  SignatureBase.prototype.createPoint = function (e) {\n    var rect = this.canvasContext.canvas.getBoundingClientRect();\n\n    if (e.type === 'mousedown' || e.type === 'mousemove') {\n      // signature\n      if (this.canvasRatio === undefined) {\n        return this.point(e.clientX - rect.left, e.clientY - rect.top, new Date().getTime());\n      } // image editor\n      else if (this.scale === 1) {\n        return this.point((e.clientX - rect.left) * this.canvasRatio.width / this.scale, (e.clientY - rect.top) * this.canvasRatio.height / this.scale, new Date().getTime());\n      } else {\n        return this.point((e.clientX - rect.left + this.panStart.startX / this.canvasRatio.width * this.scale) / this.scale * this.canvasRatio.width, (e.clientY - rect.top + this.panStart.startY / this.canvasRatio.height * this.scale) / this.scale * this.canvasRatio.height, new Date().getTime());\n      }\n    } else {\n      // signature\n      if (this.canvasRatio === undefined) {\n        return this.point(e.touches[0].clientX - rect.left, e.touches[0].clientY - rect.top, new Date().getTime());\n      } // image editor\n      else if (this.scale === 1) {\n        return this.point((e.touches[0].clientX - rect.left) * this.canvasRatio.width / this.scale, (e.touches[0].clientY - rect.top) * this.canvasRatio.height / this.scale, new Date().getTime());\n      } else {\n        return this.point(e.touches[0].clientX - rect.left + this.panStart.startX / (this.canvasRatio.width * this.scale), e.touches[0].clientY - rect.top + this.panStart.startY / (this.canvasRatio.height * this.scale), new Date().getTime());\n      }\n    }\n  };\n  /* Returns the current point corrdinates(x, y) and time.*/\n\n\n  SignatureBase.prototype.point = function (pointX, pointY, time) {\n    this.pointX = pointX;\n    this.pointY = pointY;\n    this.time = time || new Date().getTime();\n    return {\n      x: this.pointX,\n      y: this.pointY,\n      time: this.time\n    };\n  };\n\n  SignatureBase.prototype.addPoint = function (point) {\n    var points = this.pointColl;\n    var controlPoint1;\n    var controlPoint2;\n    var lastPoint = points.length > 0 && points[points.length - 1];\n    var isLastPointTooClose = lastPoint ? this.distanceTo(lastPoint) <= this.minDistance : false;\n\n    if (!lastPoint || !(lastPoint && isLastPointTooClose)) {\n      points.push(point);\n      this.imageEditorPointsColl.push(point);\n\n      if (points.length > 2) {\n        if (points.length === 3) {\n          points.unshift(points[0]);\n        }\n\n        controlPoint1 = this.calculateCurveControlPoints(points[0], points[1], points[2]).controlPoint2;\n        controlPoint2 = this.calculateCurveControlPoints(points[1], points[2], points[3]).controlPoint1;\n        this.startPoint = points[1];\n        this.controlPoint1 = controlPoint1;\n        this.controlPoint2 = controlPoint2;\n        this.endPoint = points[2];\n        this.startDraw();\n        points.shift();\n      }\n    }\n  };\n\n  SignatureBase.prototype.startDraw = function () {\n    var velocity;\n    velocity = this.pointVelocityCalc(this.startPoint);\n    velocity = this.velocity * velocity + (1 - this.velocity) * this.lastVelocity;\n    var newWidth = Math.max(this.maxStrokeWidth / (velocity + 1), this.minStrokeWidth);\n    this.curveDraw(this.lastWidth, newWidth);\n    this.lastVelocity = velocity;\n    this.lastWidth = newWidth;\n  };\n\n  SignatureBase.prototype.endDraw = function () {\n    var canDrawCurve = this.pointColl.length > 2;\n    var point = this.pointColl[0];\n\n    if (!canDrawCurve && point) {\n      this.strokeDraw(point);\n    }\n  };\n  /* Calculate the Bezier (x, y) coordinate of the curve. */\n\n\n  SignatureBase.prototype.curveDraw = function (startWidth, endWidth) {\n    var context = this.canvasContext;\n    var width;\n    var i;\n    var t1;\n    var t2;\n    var t3;\n    var u1;\n    var u2;\n    var u3;\n    var x;\n    var y;\n    var widthValue = endWidth - startWidth;\n    var bezierLength = this.bezierLengthCalc();\n    var drawSteps = Math.ceil(bezierLength) * 2;\n    context.beginPath();\n\n    for (i = 0; i < drawSteps; i++) {\n      t1 = i / drawSteps;\n      t2 = t1 * t1;\n      t3 = t2 * t1;\n      u1 = 1 - t1;\n      u2 = u1 * u1;\n      u3 = u2 * u1;\n      x = u3 * this.startPoint.x;\n      x += 3 * u2 * t1 * this.controlPoint1.x;\n      x += 3 * u1 * t2 * this.controlPoint2.x;\n      x += t3 * this.endPoint.x;\n      y = u3 * this.startPoint.y;\n      y += 3 * u2 * t1 * this.controlPoint1.y;\n      y += 3 * u1 * t2 * this.controlPoint2.y;\n      y += t3 * this.endPoint.y;\n      width = Math.min(startWidth + t3 * widthValue, this.maxStrokeWidth);\n      this.arcDraw(x, y, width);\n    }\n\n    context.closePath();\n    context.fill();\n    this.isSignatureEmpty = false;\n  };\n\n  SignatureBase.prototype.strokeDraw = function (point) {\n    var context = this.canvasContext;\n    var pointSize = (this.minStrokeWidth + this.maxStrokeWidth) / 2;\n    context.beginPath();\n    this.arcDraw(point.x, point.y, pointSize);\n    context.closePath();\n    context.fill();\n    this.isSignatureEmpty = false;\n  };\n\n  SignatureBase.prototype.arcDraw = function (x, y, size) {\n    var context = this.canvasContext;\n    context.moveTo(x, y);\n    context.arc(x, y, size, 0, 2 * Math.PI, false);\n  };\n  /* Utility functions for Bezier algorithm*/\n\n\n  SignatureBase.prototype.calculateCurveControlPoints = function (p1, p2, p3) {\n    var dx1 = p1.x - p2.x;\n    var dy1 = p1.y - p2.y;\n    var dx2 = p2.x - p3.x;\n    var dy2 = p2.y - p3.y;\n    var m1 = {\n      x: (p1.x + p2.x) / 2.0,\n      y: (p1.y + p2.y) / 2.0\n    };\n    var m2 = {\n      x: (p2.x + p3.x) / 2.0,\n      y: (p2.y + p3.y) / 2.0\n    };\n    var l1 = Math.sqrt(dx1 * dx1 + dy1 * dy1);\n    var l2 = Math.sqrt(dx2 * dx2 + dy2 * dy2);\n    var dxm = m1.x - m2.x;\n    var dym = m1.y - m2.y;\n    var k = l2 / (l1 + l2);\n    var cm = {\n      x: m2.x + dxm * k,\n      y: m2.y + dym * k\n    };\n    var tx = p2.x - cm.x;\n    var ty = p2.y - cm.y;\n    return {\n      controlPoint1: this.point(m1.x + tx, m1.y + ty, 0),\n      controlPoint2: this.point(m2.x + tx, m2.y + ty, 0)\n    };\n  };\n  /* Returns approximated bezier length of the curuve.*/\n\n\n  SignatureBase.prototype.bezierLengthCalc = function () {\n    var steps = 10;\n    var length = 0;\n    var i;\n    var t;\n    var pointx1;\n    var pointy1;\n    var pointx2;\n    var pointy2;\n    var pointx3;\n    var pointy3;\n\n    for (i = 0; i <= steps; i++) {\n      t = i / steps;\n      pointx1 = this.bezierPointCalc(t, this.startPoint.x, this.controlPoint1.x, this.controlPoint2.x, this.endPoint.x);\n      pointy1 = this.bezierPointCalc(t, this.startPoint.y, this.controlPoint1.y, this.controlPoint2.y, this.endPoint.y);\n\n      if (i > 0) {\n        pointx3 = pointx1 - pointx2;\n        pointy3 = pointy1 - pointy2;\n        length += Math.sqrt(pointx3 * pointx3 + pointy3 * pointy3);\n      }\n\n      pointx2 = pointx1;\n      pointy2 = pointy1;\n    }\n\n    return length;\n  };\n  /* Calculate parametric value of x or y given t and the\n     four point(startpoint, controlpoint1, controlpoint2, endpoint) coordinates of a cubic bezier curve.*/\n\n\n  SignatureBase.prototype.bezierPointCalc = function (t, startpoint, cp1, cp2, endpoint) {\n    return startpoint * (1.0 - t) * (1.0 - t) * (1.0 - t) + 3.0 * cp1 * (1.0 - t) * (1.0 - t) * t + 3.0 * cp2 * (1.0 - t) * t * t + endpoint * t * t * t;\n  };\n  /* Velocity between the current point and last point.*/\n\n\n  SignatureBase.prototype.pointVelocityCalc = function (startPoint) {\n    return this.time !== startPoint.time ? this.distanceTo(startPoint) / (this.time - startPoint.time) : 0;\n  };\n  /* Distance between the current point and last point.*/\n\n\n  SignatureBase.prototype.distanceTo = function (start) {\n    return Math.sqrt(Math.pow(this.pointX - start.x, 2) + Math.pow(this.pointY - start.y, 2));\n  };\n\n  SignatureBase.prototype.isRead = function (isRead) {\n    if (isRead) {\n      EventHandler.remove(this.canvasContext.canvas, 'mousedown touchstart', this.mouseDownHandler);\n    } else if (!this.disabled) {\n      EventHandler.add(this.canvasContext.canvas, 'mousedown touchstart', this.mouseDownHandler, this);\n    }\n  };\n\n  SignatureBase.prototype.enableOrDisable = function (isDisable) {\n    this.disabled = isDisable;\n\n    if (isDisable) {\n      this.reDraw('0.5');\n      this.isRead(true);\n    } else {\n      this.reDraw('1');\n      this.isRead(false);\n    }\n  };\n\n  SignatureBase.prototype.reDraw = function (opacity) {\n    var data = this.canvasContext.getImageData(0, 0, this.element.width, this.element.height);\n    this.canvasContext.clearRect(0, 0, this.element.width, this.element.height);\n    this.element.style.opacity = opacity;\n    this.canvasContext.putImageData(data, 0, 0);\n  };\n\n  SignatureBase.prototype.updateSnapCollection = function (isClear) {\n    if (isNullOrUndefined(this.incStep)) {\n      this.incStep = -1;\n      this.incStep++;\n      this.snapColl = [];\n      this.clearArray = [];\n    } else {\n      this.incStep++;\n    }\n\n    if (this.incStep < this.snapColl.length) {\n      this.snapColl.length = this.incStep;\n    }\n\n    if (this.incStep > 0) {\n      var canvasNew = this.createElement('canvas', {\n        className: 'e-' + this.getModuleName() + '-wrapper'\n      });\n      var canvasContextNew = canvasNew.getContext('2d');\n      canvasNew.width = this.canvasContext.canvas.width;\n      canvasNew.height = this.canvasContext.canvas.height;\n      canvasContextNew.drawImage(this.canvasContext.canvas, 0, 0, canvasNew.width, canvasNew.height);\n      this.snapColl.push(canvasNew.toDataURL());\n    } else {\n      this.snapColl.push(this.canvasContext.canvas.toDataURL());\n    }\n\n    if (isClear) {\n      this.clearArray.push(this.incStep);\n    }\n  };\n\n  SignatureBase.prototype.setBackgroundImage = function (imageSrc) {\n    // eslint-disable-next-line @typescript-eslint/no-this-alias\n    var proxy = this;\n    var imageObj = new Image();\n    imageObj.crossOrigin = 'anonymous';\n    imageObj.src = imageSrc;\n\n    imageObj.onload = function () {\n      proxy.canvasContext.globalCompositeOperation = 'source-over';\n      proxy.canvasContext.drawImage(imageObj, 0, 0, proxy.element.width, proxy.element.height);\n      proxy.updateSnapCollection();\n      proxy.saveBackground(true);\n    };\n\n    this.canvasContext.clearRect(0, 0, this.canvasContext.canvas.width, this.canvasContext.canvas.height);\n  };\n\n  SignatureBase.prototype.setBackgroundColor = function (color) {\n    var canvasEle = this.canvasContext;\n    canvasEle.strokeStyle = color;\n    var i;\n    var j;\n\n    for (i = 1; i <= canvasEle.canvas.width; i++) {\n      for (j = 1; j <= canvasEle.canvas.height; j++) {\n        canvasEle.strokeRect(0, 0, i, j);\n      }\n    }\n\n    this.updateSnapCollection();\n  };\n\n  SignatureBase.prototype.loadPersistedSignature = function () {\n    if (isNullOrUndefined(this.signatureValue)) {\n      return;\n    } // eslint-disable-next-line @typescript-eslint/no-this-alias\n\n\n    var proxy = this;\n    var lastImage = new Image();\n    lastImage.src = this.signatureValue;\n\n    lastImage.onload = function () {\n      proxy.canvasContext.clearRect(0, 0, proxy.element.width, proxy.element.height);\n      proxy.canvasContext.drawImage(lastImage, 0, 0);\n      proxy.updateSnapCollection();\n    };\n\n    this.isSignatureEmpty = false;\n  };\n  /**\n   * To get the signature as Blob.\n   *\n   * @param {string} url - specify the url/base 64 string to get blob of the signature.\n   * @returns {Blob}.\n   */\n\n\n  SignatureBase.prototype.getBlob = function (url) {\n    var arr = url.split(',');\n    var type = arr[0].match(/:(.*?);/)[1];\n    var bstr = atob(arr[1]);\n    var n = bstr.length;\n    var u8arr = new Uint8Array(n);\n\n    while (n--) {\n      u8arr[n] = bstr.charCodeAt(n);\n    }\n\n    return new Blob([u8arr], {\n      type: type\n    });\n  };\n\n  SignatureBase.prototype.download = function (blob, fileName) {\n    var blobUrl = URL.createObjectURL(blob);\n    var a = document.createElement('a');\n    a.href = blobUrl;\n    a.target = '_parent';\n    a.download = fileName;\n    (document.body || document.documentElement).appendChild(a);\n    a.click();\n    a.parentNode.removeChild(a);\n  };\n  /**\n   * To refresh the signature.\n   *\n   * @private\n   * @returns {void}.\n   */\n\n\n  SignatureBase.prototype.refresh = function () {\n    this.pointColl = [];\n    this.lastVelocity = 0;\n    this.lastWidth = (this.minStrokeWidth + this.maxStrokeWidth) / 2;\n  };\n  /**\n   * Erases all the signature strokes signed by user.\n   *\n   * @returns {void}.\n   */\n\n\n  SignatureBase.prototype.clear = function () {\n    var args = {\n      actionName: 'clear'\n    };\n    this.canvasContext.clearRect(0, 0, this.canvasContext.canvas.width, this.canvasContext.canvas.height);\n    this.refresh();\n    this.updateSnapCollection(true);\n    this.isSignatureEmpty = true;\n\n    if (!this.isBlazor) {\n      this.trigger('change', args);\n    } else {\n      this.dotnetRef.invokeMethodAsync('TriggerEventAsync', 'Clear');\n    }\n  };\n  /**\n   * Undo the last user action.\n   *\n   * @returns {void}.\n   */\n\n\n  SignatureBase.prototype.undo = function () {\n    var args = {\n      actionName: 'undo'\n    }; // eslint-disable-next-line @typescript-eslint/no-this-alias\n\n    var proxy = this;\n\n    if (this.incStep > 0) {\n      this.incStep--;\n      var undoImg_1 = new Image();\n      undoImg_1.src = this.snapColl[this.incStep];\n\n      undoImg_1.onload = function () {\n        proxy.canvasContext.clearRect(0, 0, proxy.element.width, proxy.element.height);\n        proxy.canvasContext.drawImage(undoImg_1, 0, 0, proxy.element.width, proxy.element.height);\n      };\n    }\n\n    this.isClear();\n\n    if (!this.isBlazor) {\n      this.trigger('change', args);\n    } else {\n      this.dotnetRef.invokeMethodAsync('TriggerEventAsync', 'Undo');\n    }\n  };\n  /**\n   * Redo the last user action.\n   *\n   * @returns {void}.\n   */\n\n\n  SignatureBase.prototype.redo = function () {\n    var args = {\n      actionName: 'redo'\n    }; // eslint-disable-next-line @typescript-eslint/no-this-alias\n\n    var proxy = this;\n\n    if (this.incStep < this.snapColl.length - 1) {\n      this.incStep++;\n      var redoImg_1 = new Image();\n      redoImg_1.src = this.snapColl[this.incStep];\n\n      redoImg_1.onload = function () {\n        proxy.canvasContext.clearRect(0, 0, proxy.element.width, proxy.element.height);\n        proxy.canvasContext.drawImage(redoImg_1, 0, 0, proxy.element.width, proxy.element.height);\n      };\n    }\n\n    this.isClear();\n\n    if (!this.isBlazor) {\n      this.trigger('change', args);\n    } else {\n      this.dotnetRef.invokeMethodAsync('TriggerEventAsync', 'Redo');\n    }\n  };\n\n  SignatureBase.prototype.isClear = function () {\n    if (this.clearArray) {\n      var empty = false;\n\n      for (var i = 0; i < this.clearArray.length; i++) {\n        if (this.clearArray[i] === this.incStep) {\n          this.isSignatureEmpty = true;\n          empty = true;\n        }\n      }\n\n      if (!empty) {\n        this.isSignatureEmpty = false;\n      }\n    }\n  };\n  /**\n   * To check whether the signature is empty or not.\n   *\n   * @returns {boolean}.\n   */\n\n\n  SignatureBase.prototype.isEmpty = function () {\n    return this.isSignatureEmpty;\n  };\n  /**\n   * To check whether the undo collection is empty or not.\n   *\n   * @returns {boolean}.\n   */\n\n\n  SignatureBase.prototype.canUndo = function () {\n    return this.incStep > 0;\n  };\n  /**\n   * To check whether the redo collection is empty or not.\n   *\n   * @returns {boolean}.\n   */\n\n\n  SignatureBase.prototype.canRedo = function () {\n    return this.incStep < this.snapColl.length - 1;\n  };\n  /**\n   * To draw the signature based on the given text, with the font family and font size.\n   *\n   * @param {string} text - specify text to be drawn as signature.\n   * @param {string} fontFamily - specify font family of a signature.\n   * @param {number} fontSize - specify font size of a signature.\n   *\n   * @returns {void}.\n   */\n\n\n  SignatureBase.prototype.draw = function (text, fontFamily, fontSize) {\n    this.canvasContext.clearRect(0, 0, this.canvasContext.canvas.width, this.canvasContext.canvas.height);\n    fontFamily = fontFamily || 'Arial';\n    fontSize = fontSize || 30;\n    this.canvasContext.font = fontSize + 'px ' + fontFamily;\n    this.canvasContext.textAlign = 'center';\n    this.canvasContext.textBaseline = 'middle';\n    this.canvasContext.fillText(text, this.element.width / 2, this.element.height / 2);\n    this.updateSnapCollection();\n    this.isSignatureEmpty = false;\n  };\n  /**\n   * To load the signature with the given base 64 string, height and width.\n   *\n   * @param {string} signature - specify the url/base 64 string to be drawn as signature.\n   * @param {number} width - specify the width of the loaded signature image.\n   * @param {number} height - specify the height of the loaded signature image.\n   * @returns {void}.\n   */\n\n\n  SignatureBase.prototype.load = function (signature, width, height) {\n    height = height || this.element.height;\n    width = width || this.element.width;\n    this.canvasContext.clearRect(0, 0, this.canvasContext.canvas.width, this.canvasContext.canvas.height); // eslint-disable-next-line @typescript-eslint/no-this-alias\n\n    var proxy = this;\n    var bitmapImage = new Image();\n    bitmapImage.src = signature;\n\n    if (signature.slice(0, 4) !== 'data') {\n      bitmapImage.crossOrigin = 'anonymous';\n    }\n\n    bitmapImage.onload = function () {\n      Promise.all([createImageBitmap(bitmapImage, 0, 0, width, height)]).then(function (results) {\n        var tempCanvas = document.createElement('canvas');\n        tempCanvas.width = width;\n        tempCanvas.height = height;\n        tempCanvas.getContext('2d').drawImage(results[0], 0, 0);\n\n        if (signature.slice(0, 4) !== 'data') {\n          proxy.canvasContext.globalCompositeOperation = 'source-over';\n        }\n\n        proxy.canvasContext.drawImage(tempCanvas, 0, 0, width, height, 0, 0, proxy.element.width, proxy.element.height);\n        proxy.updateSnapCollection();\n      });\n    };\n\n    this.isSignatureEmpty = false;\n  };\n\n  SignatureBase.prototype.saveBackground = function (savebg) {\n    var imageSrc;\n\n    if (savebg && this.backgroundImage) {\n      imageSrc = this.snapColl[this.incStep - 1];\n    } else {\n      imageSrc = this.snapColl[this.incStep];\n    }\n\n    if (!savebg) {\n      this.canvasContext.clearRect(0, 0, this.canvasContext.canvas.width, this.canvasContext.canvas.height);\n\n      if (this.backgroundImage) {\n        this.setBackgroundImage(this.backgroundImage);\n      } else if (this.backgroundColor) {\n        this.setBackgroundColor(this.backgroundColor);\n        savebg = true;\n      }\n    }\n\n    if (savebg) {\n      // eslint-disable-next-line @typescript-eslint/no-this-alias\n      var proxy_1 = this;\n      var imageObj_1 = new Image();\n      imageObj_1.crossOrigin = 'anonymous';\n      imageObj_1.src = imageSrc;\n\n      imageObj_1.onload = function () {\n        proxy_1.backgroundLoaded = true;\n        proxy_1.canvasContext.globalCompositeOperation = 'source-over';\n        proxy_1.canvasContext.drawImage(imageObj_1, 0, 0, proxy_1.element.width, proxy_1.element.height);\n        proxy_1.save(proxy_1.fileType, proxy_1.fileName);\n      };\n    }\n  };\n  /**\n   * To save the signature with the given file type and file name.\n   *\n   * @param {SignatureFileType} type - specify type of the file to be saved a signature.\n   * @param {string} fileName - specify name of the file to be saved a signature.\n   *\n   * @returns {void}.\n   */\n\n\n  SignatureBase.prototype.save = function (type, fileName) {\n    if (this.saveWithBackground && this.backgroundLoaded == null && (this.backgroundImage || this.backgroundColor)) {\n      this.backgroundLoaded = false;\n      this.fileType = type;\n      this.fileName = fileName;\n      this.saveBackground(false);\n    } else if (type === 'Svg') {\n      fileName = fileName || 'Signature';\n      this.toSVG(fileName);\n    } else if (type === 'Jpeg') {\n      fileName = fileName || 'Signature';\n\n      if (!this.saveWithBackground || this.saveWithBackground && !(this.backgroundImage || this.backgroundColor)) {\n        this.toJPEG(fileName);\n      } else {\n        var dataURL = this.canvasContext.canvas.toDataURL('image/jpeg');\n        this.download(this.getBlob(dataURL), fileName + '.' + 'jpeg');\n      }\n    } else {\n      fileName = fileName || 'Signature';\n      var dataURL = this.canvasContext.canvas.toDataURL('image/png');\n      this.download(this.getBlob(dataURL), fileName + '.' + 'png');\n    }\n\n    if (this.saveWithBackground && this.backgroundLoaded) {\n      this.resetSnap();\n    }\n  };\n\n  SignatureBase.prototype.resetSnap = function () {\n    this.canvasContext.clearRect(0, 0, this.canvasContext.canvas.width, this.canvasContext.canvas.height); // eslint-disable-next-line @typescript-eslint/no-this-alias\n\n    var proxy = this;\n    var restoreObj = new Image();\n    restoreObj.src = this.snapColl[this.incStep - 1];\n\n    restoreObj.onload = function () {\n      proxy.canvasContext.drawImage(restoreObj, 0, 0, proxy.element.width, proxy.element.height);\n      proxy.updateSnapCollection();\n    };\n\n    this.backgroundLoaded = null;\n    this.snapColl.pop();\n    this.incStep--;\n    this.snapColl.pop();\n    this.incStep--;\n  };\n\n  SignatureBase.prototype.toJPEG = function (fileName) {\n    var _this = this;\n\n    var imageSrc = this.snapColl[this.incStep];\n    this.setBackgroundColor('#ffffff'); // eslint-disable-next-line @typescript-eslint/no-this-alias\n\n    var proxy = this;\n    var imageObj = new Image();\n    imageObj.crossOrigin = 'anonymous';\n    imageObj.src = imageSrc;\n\n    imageObj.onload = function () {\n      proxy.canvasContext.globalCompositeOperation = 'source-over';\n      proxy.canvasContext.drawImage(imageObj, 0, 0, proxy.element.width, proxy.element.height);\n      var dataURL = proxy.canvasContext.canvas.toDataURL('image/jpeg');\n      proxy.download(proxy.getBlob(dataURL), fileName + '.' + 'jpeg');\n      proxy.canvasContext.clearRect(0, 0, proxy.canvasContext.canvas.width, proxy.canvasContext.canvas.height);\n\n      _this.resizeHandler();\n    };\n\n    this.snapColl.pop();\n    this.incStep--;\n  };\n\n  SignatureBase.prototype.toSVG = function (fileName) {\n    var dataUrl = this.canvasContext.canvas.toDataURL();\n    var svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');\n    svg.setAttribute('width', this.canvasContext.canvas.width.toString());\n    svg.setAttribute('height', this.canvasContext.canvas.height.toString());\n    var XLinkNS = 'http://www.w3.org/1999/xlink';\n    var img = document.createElementNS('http://www.w3.org/2000/svg', 'image');\n    img.setAttributeNS(null, 'height', this.canvasContext.canvas.height.toString());\n    img.setAttributeNS(null, 'width', this.canvasContext.canvas.width.toString());\n    img.setAttributeNS(XLinkNS, 'xlink:href', dataUrl);\n    svg.appendChild(img);\n    var prefix = 'data:image/svg+xml;base64,';\n    var header = '<svg' + ' xmlns=\"http://www.w3.org/2000/svg\"' + ' xmlns:xlink=\"http://www.w3.org/1999/xlink\"' + (\" width=\\\"\" + this.canvasContext.canvas.width + \"\\\"\") + (\" height=\\\"\" + this.canvasContext.canvas.height + \"\\\"\") + '>';\n    var footer = '</svg>';\n    var body = svg.innerHTML;\n    var data = header + body + footer;\n    var svgDataUrl = prefix + btoa(data);\n\n    if (fileName == null) {\n      return svgDataUrl;\n    } else {\n      this.download(this.getBlob(svgDataUrl), fileName + '.' + 'svg');\n      return null;\n    }\n  };\n  /**\n   * To save the signature as Blob.\n   *\n   * @returns {Blob}.\n   */\n\n\n  SignatureBase.prototype.saveAsBlob = function () {\n    return this.getBlob(this.canvasContext.canvas.toDataURL('image/png'));\n  };\n  /**\n   * To get the signature as Base 64.\n   *\n   * @private\n   * @param {SignatureFileType} type - Specifies the type of the image format.\n   * @returns {string}.\n   */\n\n\n  SignatureBase.prototype.getSignature = function (type) {\n    if (type === 'Jpeg') {\n      var imgData = this.canvasContext.getImageData(0, 0, this.element.width, this.element.height);\n      var data = imgData.data;\n\n      for (var i = 0; i < data.length; i += 4) {\n        if (data[i + 3] < 255) {\n          data[i] = 255 - data[i];\n          data[i + 1] = 255 - data[i + 1];\n          data[i + 2] = 255 - data[i + 2];\n          data[i + 3] = 255 - data[i + 3];\n        }\n      }\n\n      this.canvasContext.putImageData(imgData, 0, 0);\n      var dataURL = this.canvasContext.canvas.toDataURL('image/jpeg');\n      this.resizeHandler();\n      return dataURL;\n    } else if (type === 'Svg') {\n      return this.toSVG(null);\n    } else {\n      return this.canvasContext.canvas.toDataURL('image/png');\n    }\n  };\n  /**\n   * Get component name.\n   *\n   * @returns {string} - Module Name\n   * @private\n   */\n\n\n  SignatureBase.prototype.getModuleName = function () {\n    return 'signature';\n  };\n  /**\n   * To get the properties to be maintained in the persisted state.\n   *\n   * @returns {string} - Persist data\n   */\n\n\n  SignatureBase.prototype.getPersistData = function () {\n    this.signatureValue = this.snapColl[this.incStep];\n    return this.addOnPersist(['signatureValue']);\n  };\n  /**\n   * Removes the component from the DOM and detaches all its related event handlers.\n   * Also it maintains the initial input element from the DOM.\n   *\n   * @method destroy\n   * @returns {void}\n   */\n\n\n  SignatureBase.prototype.destroy = function () {\n    if (this.getModuleName() !== 'image-editor') {\n      this.unwireEvents(null);\n      removeClass([this.element], 'e-' + this.getModuleName());\n      this.element.removeAttribute('tabindex');\n      this.pointColl = null;\n    }\n\n    _super.prototype.destroy.call(this);\n  };\n  /**\n   * Modified onPropertyChanged method for both blazor and EJ2 signature component.\n   *\n   * @private\n   * @param {string} key - Specifies the property, which changed.\n   * @param {string} value - Specifies the property value changed.\n   * @returns {void}\n   */\n\n\n  SignatureBase.prototype.propertyChanged = function (key, value) {\n    var canvasNew = this.canvasContext;\n\n    switch (key) {\n      case 'backgroundColor':\n        canvasNew.canvas.style.backgroundColor = value;\n        this.backgroundColor = value;\n        break;\n\n      case 'backgroundImage':\n        canvasNew.canvas.style.backgroundImage = 'url(' + value + ')';\n        this.backgroundImage = value;\n        break;\n\n      case 'strokeColor':\n        canvasNew.fillStyle = value;\n        this.strokeColor = value;\n        break;\n\n      case 'saveWithBackground':\n        this.saveWithBackground = value;\n        break;\n\n      case 'maxStrokeWidth':\n        this.maxStrokeWidth = value;\n        break;\n\n      case 'minStrokeWidth':\n        this.minStrokeWidth = value;\n        break;\n\n      case 'velocity':\n        this.velocity = value;\n        break;\n\n      case 'isReadOnly':\n        this.isRead(value);\n        break;\n\n      case 'disabled':\n        this.enableOrDisable(value);\n        break;\n    }\n  };\n\n  return SignatureBase;\n}(Component);\n\nexport { SignatureBase };","map":{"version":3,"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","Component","removeClass","EventHandler","isNullOrUndefined","SignatureBase","_super","_this","apply","arguments","minDistance","previous","interval","timeout","isSignatureEmpty","backgroundLoaded","clearArray","isBlazor","isResponsive","imageEditorPointsColl","initialize","element","dotnetRef","canvasContext","getContext","canvas","tabIndex","signatureValue","loadPersistedSignature","setHTMLProperties","updateSnapCollection","wireEvents","trigger","pointColl","isReadOnly","disabled","add","mouseDownHandler","keyboardHandler","window","addEventListener","resizeHandler","bind","mouseMoveHandler","mouseUpHandler","document","unwireEvents","type","remove","removeEventListener","height","width","offsetHeight","offsetWidth","scale","fillStyle","strokeColor","backgroundImage","style","backgroundRepeat","backgroundColor","e","panStart","zoomState","buttons","preventDefault","stopPropagation","beginStroke","updateStrokeWithThrottle","updateStroke","args","actionName","endDraw","invokeMethodAsync","snapColl","incStep","fileName","cancel","key","clear","ctrlKey","observableSaveArgs","save","stopImmediatePropagation","undo","redo","proxy","restoreImg","Image","src","onload","clearRect","drawImage","refresh","point","createPoint","addPoint","now","Date","remaining","storedArgs","clearTimeout","setTimeout","delay","rect","getBoundingClientRect","canvasRatio","undefined","clientX","left","clientY","top","getTime","startX","startY","touches","pointX","pointY","time","x","y","points","controlPoint1","controlPoint2","lastPoint","length","isLastPointTooClose","distanceTo","push","unshift","calculateCurveControlPoints","startPoint","endPoint","startDraw","shift","velocity","pointVelocityCalc","lastVelocity","newWidth","Math","max","maxStrokeWidth","minStrokeWidth","curveDraw","lastWidth","canDrawCurve","strokeDraw","startWidth","endWidth","context","i","t1","t2","t3","u1","u2","u3","widthValue","bezierLength","bezierLengthCalc","drawSteps","ceil","beginPath","min","arcDraw","closePath","fill","pointSize","size","moveTo","arc","PI","p1","p2","p3","dx1","dy1","dx2","dy2","m1","m2","l1","sqrt","l2","dxm","dym","k","cm","tx","ty","steps","t","pointx1","pointy1","pointx2","pointy2","pointx3","pointy3","bezierPointCalc","startpoint","cp1","cp2","endpoint","start","pow","isRead","enableOrDisable","isDisable","reDraw","opacity","data","getImageData","putImageData","isClear","canvasNew","createElement","className","getModuleName","canvasContextNew","toDataURL","setBackgroundImage","imageSrc","imageObj","crossOrigin","globalCompositeOperation","saveBackground","setBackgroundColor","color","canvasEle","strokeStyle","j","strokeRect","lastImage","getBlob","url","arr","split","match","bstr","atob","n","u8arr","Uint8Array","charCodeAt","Blob","download","blob","blobUrl","URL","createObjectURL","a","href","target","body","documentElement","appendChild","click","parentNode","removeChild","undoImg_1","redoImg_1","empty","isEmpty","canUndo","canRedo","draw","text","fontFamily","fontSize","font","textAlign","textBaseline","fillText","load","signature","bitmapImage","slice","Promise","all","createImageBitmap","then","results","tempCanvas","savebg","proxy_1","imageObj_1","fileType","saveWithBackground","toSVG","toJPEG","dataURL","resetSnap","restoreObj","pop","dataUrl","svg","createElementNS","setAttribute","toString","XLinkNS","img","setAttributeNS","prefix","header","footer","innerHTML","svgDataUrl","btoa","saveAsBlob","getSignature","imgData","getPersistData","addOnPersist","destroy","removeAttribute","call","propertyChanged","value"],"sources":["C:/Users/chick/OneDrive/Documents/Workout app/my-app/node_modules/@syncfusion/ej2-inputs/src/common/signature-base.js"],"sourcesContent":["var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { Component, removeClass } from '@syncfusion/ej2-base';\nimport { EventHandler, isNullOrUndefined } from '@syncfusion/ej2-base';\nvar SignatureBase = /** @class */ (function (_super) {\n    __extends(SignatureBase, _super);\n    function SignatureBase() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        /* minDistance(distance between the two point) was calaculated for smoothness.*/\n        _this.minDistance = 5;\n        _this.previous = 0;\n        /* interval handles for the smoothness in the mouse move event.*/\n        _this.interval = 30;\n        _this.timeout = null;\n        _this.isSignatureEmpty = true;\n        _this.backgroundLoaded = null;\n        _this.clearArray = [];\n        _this.isBlazor = false;\n        _this.isResponsive = false;\n        _this.imageEditorPointsColl = [];\n        return _this;\n    }\n    /**\n     * To Initialize the component rendering\n     *\n     * @private\n     * @param {HTMLCanvasElement} element - Specifies the canvas element.\n     * @param {BlazorDotnetObject} dotnetRef - Specifies for blazor client to server communication.\n     * @returns {void}\n     */\n    SignatureBase.prototype.initialize = function (element, dotnetRef) {\n        this.element = element;\n        this.canvasContext = this.element.getContext('2d');\n        this.canvasContext.canvas.tabIndex = 0;\n        if (dotnetRef) {\n            this.dotnetRef = dotnetRef;\n            this.isBlazor = true;\n            if (this.signatureValue) {\n                this.loadPersistedSignature();\n            }\n        }\n        this.setHTMLProperties();\n        if (isNullOrUndefined(this.signatureValue)) {\n            this.updateSnapCollection(true);\n        }\n        this.wireEvents();\n        if (!this.isBlazor) {\n            this.trigger('created', null);\n        }\n    };\n    SignatureBase.prototype.wireEvents = function () {\n        if (isNullOrUndefined(this.pointColl) && !this.isReadOnly && !this.disabled) {\n            EventHandler.add(this.canvasContext.canvas, 'mousedown touchstart', this.mouseDownHandler, this);\n            EventHandler.add(this.canvasContext.canvas, 'keydown', this.keyboardHandler, this);\n            window.addEventListener('resize', this.resizeHandler.bind(this));\n        }\n        else if (this.pointColl) {\n            EventHandler.add(this.canvasContext.canvas, 'mousemove touchmove', this.mouseMoveHandler, this);\n            EventHandler.add(this.canvasContext.canvas, 'mouseup touchend', this.mouseUpHandler, this);\n            EventHandler.add(document, 'mouseup', this.mouseUpHandler, this);\n        }\n    };\n    SignatureBase.prototype.unwireEvents = function (type) {\n        if (type === 'mouseup' || type === 'touchend') {\n            EventHandler.remove(this.canvasContext.canvas, 'mousemove touchmove', this.mouseMoveHandler);\n            EventHandler.remove(this.canvasContext.canvas, 'mouseup touchend', this.mouseUpHandler);\n            EventHandler.remove(document, 'mouseup', this.mouseUpHandler);\n        }\n        else {\n            EventHandler.remove(this.canvasContext.canvas, 'mousedown touchstart', this.mouseDownHandler);\n            EventHandler.remove(this.canvasContext.canvas, 'keydown', this.keyboardHandler);\n            window.removeEventListener('resize', this.resizeHandler);\n        }\n    };\n    SignatureBase.prototype.setHTMLProperties = function () {\n        if (this.element.height === 150 && this.element.width === 300) {\n            this.element.height = this.element.offsetHeight;\n            this.element.width = this.element.offsetWidth;\n            this.isResponsive = true;\n        }\n        this.canvasContext.scale(1, 1);\n        this.canvasContext.fillStyle = this.strokeColor;\n        if (this.backgroundImage) {\n            this.canvasContext.canvas.style.backgroundImage = 'url(' + this.backgroundImage + ')';\n            this.canvasContext.canvas.style.backgroundRepeat = 'no-repeat';\n        }\n        else if (this.backgroundColor) {\n            this.canvasContext.canvas.style.backgroundColor = this.backgroundColor;\n        }\n    };\n    SignatureBase.prototype.mouseDownHandler = function (e, canvas, panStart, zoomState) {\n        if (e.buttons === 1 || e.buttons === 2 || e.type === 'touchstart') {\n            if (e.type === 'touchstart') {\n                e.preventDefault();\n                e.stopPropagation();\n            }\n            if (canvas) {\n                this.canvasContext = canvas.getContext('2d');\n                this.scale = zoomState;\n                this.panStart = panStart;\n            }\n            this.beginStroke(e);\n            this.wireEvents();\n        }\n    };\n    SignatureBase.prototype.mouseMoveHandler = function (e) {\n        if (e.buttons === 1 || e.buttons === 2 || e.type === 'touchmove') {\n            if (e.type === 'touchmove') {\n                e.preventDefault();\n                e.stopPropagation();\n            }\n            if (this.interval) {\n                this.updateStrokeWithThrottle(e);\n            }\n            else {\n                this.updateStroke(e);\n            }\n        }\n    };\n    SignatureBase.prototype.mouseUpHandler = function (e) {\n        var args = { actionName: 'strokeUpdate' };\n        if (e.type === 'touchstart') {\n            e.preventDefault();\n            e.stopPropagation();\n        }\n        this.endDraw();\n        this.updateSnapCollection();\n        this.unwireEvents(e.type);\n        if (!this.isBlazor) {\n            this.trigger('change', args);\n        }\n        else {\n            this.dotnetRef.invokeMethodAsync('TriggerEventAsync', 'mouseUp');\n        }\n        this.signatureValue = this.snapColl[this.incStep];\n    };\n    SignatureBase.prototype.keyboardHandler = function (e) {\n        var _this = this;\n        var args = { fileName: 'Signature', type: 'Png', cancel: false };\n        switch (e.key) {\n            case 'Delete':\n                this.clear();\n                break;\n            case (e.ctrlKey && 's'):\n                if (!this.isBlazor) {\n                    this.trigger('beforeSave', args, function (observableSaveArgs) {\n                        if (!args.cancel) {\n                            _this.save(observableSaveArgs.type, observableSaveArgs.fileName);\n                        }\n                    });\n                }\n                else {\n                    this.dotnetRef.invokeMethodAsync('TriggerEventAsync', 'beforeSave');\n                }\n                e.preventDefault();\n                e.stopImmediatePropagation();\n                break;\n            case (e.ctrlKey && 'z'):\n                this.undo();\n                break;\n            case (e.ctrlKey && 'y'):\n                this.redo();\n                break;\n        }\n    };\n    SignatureBase.prototype.resizeHandler = function () {\n        // eslint-disable-next-line @typescript-eslint/no-this-alias\n        var proxy = this;\n        if (this.isResponsive) {\n            this.canvasContext.canvas.width = this.element.offsetWidth;\n            this.canvasContext.canvas.height = this.element.offsetHeight;\n            this.canvasContext.scale(1, 1);\n        }\n        var restoreImg = new Image();\n        restoreImg.src = this.snapColl[this.incStep];\n        restoreImg.onload = function () {\n            proxy.canvasContext.clearRect(0, 0, proxy.element.width, proxy.element.height);\n            proxy.canvasContext.drawImage(restoreImg, 0, 0, proxy.element.width, proxy.element.height);\n        };\n    };\n    SignatureBase.prototype.beginStroke = function (e) {\n        this.refresh();\n        this.updateStroke(e);\n    };\n    SignatureBase.prototype.updateStroke = function (e) {\n        var point = this.createPoint(e);\n        this.addPoint(point);\n    };\n    SignatureBase.prototype.updateStrokeWithThrottle = function (args) {\n        var now = Date.now();\n        var remaining = this.interval - (now - this.previous);\n        this.storedArgs = args;\n        if (remaining <= 0 || remaining > this.interval) {\n            if (this.timeout) {\n                clearTimeout(this.timeout);\n                this.timeout = null;\n            }\n            this.previous = now;\n            this.updateStroke(this.storedArgs);\n            if (!this.timeout) {\n                this.storedArgs = null;\n            }\n        }\n        else if (!this.timeout) {\n            this.timeout = window.setTimeout(this.delay.bind(this), remaining);\n        }\n    };\n    SignatureBase.prototype.delay = function () {\n        this.previous = Date.now();\n        this.timeout = null;\n        this.updateStroke(this.storedArgs);\n        if (!this.timeout) {\n            this.storedArgs = null;\n        }\n    };\n    SignatureBase.prototype.createPoint = function (e) {\n        var rect = this.canvasContext.canvas.getBoundingClientRect();\n        if (e.type === 'mousedown' || e.type === 'mousemove') {\n            // signature\n            if (this.canvasRatio === undefined) {\n                return this.point(e.clientX - rect.left, e.clientY - rect.top, new Date().getTime());\n            }\n            // image editor\n            else if (this.scale === 1) {\n                return this.point(((e.clientX - rect.left) * this.canvasRatio.width) / this.scale, ((e.clientY - rect.top) * this.canvasRatio.height) / this.scale, new Date().getTime());\n            }\n            else {\n                return this.point((((e.clientX - rect.left) + ((this.panStart.startX) / this.canvasRatio.width\n                    * this.scale)) / this.scale) * this.canvasRatio.width, (((e.clientY - rect.top) + ((this.panStart.startY) / this.canvasRatio.height\n                    * this.scale)) / this.scale) * this.canvasRatio.height, new Date().getTime());\n            }\n        }\n        else {\n            // signature\n            if (this.canvasRatio === undefined) {\n                return this.point(e.touches[0].clientX - rect.left, e.touches[0].clientY - rect.top, new Date().getTime());\n            }\n            // image editor\n            else if (this.scale === 1) {\n                return this.point(((e.touches[0].clientX - rect.left) * this.canvasRatio.width) / this.scale, ((e.touches[0].clientY - rect.top) * this.canvasRatio.height) / this.scale, new Date().getTime());\n            }\n            else {\n                return this.point((e.touches[0].clientX - rect.left) + this.panStart.startX / (this.canvasRatio.width\n                    * this.scale), (e.touches[0].clientY - rect.top) + this.panStart.startY / (this.canvasRatio.height\n                    * this.scale), new Date().getTime());\n            }\n        }\n    };\n    /* Returns the current point corrdinates(x, y) and time.*/\n    SignatureBase.prototype.point = function (pointX, pointY, time) {\n        this.pointX = pointX;\n        this.pointY = pointY;\n        this.time = time || new Date().getTime();\n        return { x: this.pointX, y: this.pointY, time: this.time };\n    };\n    SignatureBase.prototype.addPoint = function (point) {\n        var points = this.pointColl;\n        var controlPoint1;\n        var controlPoint2;\n        var lastPoint = points.length > 0 && points[points.length - 1];\n        var isLastPointTooClose = lastPoint ? this.distanceTo(lastPoint) <= this.minDistance : false;\n        if (!lastPoint || !(lastPoint && isLastPointTooClose)) {\n            points.push(point);\n            this.imageEditorPointsColl.push(point);\n            if (points.length > 2) {\n                if (points.length === 3) {\n                    points.unshift(points[0]);\n                }\n                controlPoint1 = (this.calculateCurveControlPoints(points[0], points[1], points[2])).controlPoint2;\n                controlPoint2 = (this.calculateCurveControlPoints(points[1], points[2], points[3])).controlPoint1;\n                this.startPoint = points[1];\n                this.controlPoint1 = controlPoint1;\n                this.controlPoint2 = controlPoint2;\n                this.endPoint = points[2];\n                this.startDraw();\n                points.shift();\n            }\n        }\n    };\n    SignatureBase.prototype.startDraw = function () {\n        var velocity;\n        velocity = this.pointVelocityCalc(this.startPoint);\n        velocity = this.velocity * velocity + (1 - this.velocity) * this.lastVelocity;\n        var newWidth = Math.max(this.maxStrokeWidth / (velocity + 1), this.minStrokeWidth);\n        this.curveDraw(this.lastWidth, newWidth);\n        this.lastVelocity = velocity;\n        this.lastWidth = newWidth;\n    };\n    SignatureBase.prototype.endDraw = function () {\n        var canDrawCurve = this.pointColl.length > 2;\n        var point = this.pointColl[0];\n        if (!canDrawCurve && point) {\n            this.strokeDraw(point);\n        }\n    };\n    /* Calculate the Bezier (x, y) coordinate of the curve. */\n    SignatureBase.prototype.curveDraw = function (startWidth, endWidth) {\n        var context = this.canvasContext;\n        var width;\n        var i;\n        var t1;\n        var t2;\n        var t3;\n        var u1;\n        var u2;\n        var u3;\n        var x;\n        var y;\n        var widthValue = endWidth - startWidth;\n        var bezierLength = this.bezierLengthCalc();\n        var drawSteps = Math.ceil(bezierLength) * 2;\n        context.beginPath();\n        for (i = 0; i < drawSteps; i++) {\n            t1 = i / drawSteps;\n            t2 = t1 * t1;\n            t3 = t2 * t1;\n            u1 = 1 - t1;\n            u2 = u1 * u1;\n            u3 = u2 * u1;\n            x = u3 * this.startPoint.x;\n            x += 3 * u2 * t1 * this.controlPoint1.x;\n            x += 3 * u1 * t2 * this.controlPoint2.x;\n            x += t3 * this.endPoint.x;\n            y = u3 * this.startPoint.y;\n            y += 3 * u2 * t1 * this.controlPoint1.y;\n            y += 3 * u1 * t2 * this.controlPoint2.y;\n            y += t3 * this.endPoint.y;\n            width = Math.min(startWidth + t3 * widthValue, this.maxStrokeWidth);\n            this.arcDraw(x, y, width);\n        }\n        context.closePath();\n        context.fill();\n        this.isSignatureEmpty = false;\n    };\n    SignatureBase.prototype.strokeDraw = function (point) {\n        var context = this.canvasContext;\n        var pointSize = (this.minStrokeWidth + this.maxStrokeWidth) / 2;\n        context.beginPath();\n        this.arcDraw(point.x, point.y, pointSize);\n        context.closePath();\n        context.fill();\n        this.isSignatureEmpty = false;\n    };\n    SignatureBase.prototype.arcDraw = function (x, y, size) {\n        var context = this.canvasContext;\n        context.moveTo(x, y);\n        context.arc(x, y, size, 0, 2 * Math.PI, false);\n    };\n    /* Utility functions for Bezier algorithm*/\n    SignatureBase.prototype.calculateCurveControlPoints = function (p1, p2, p3) {\n        var dx1 = p1.x - p2.x;\n        var dy1 = p1.y - p2.y;\n        var dx2 = p2.x - p3.x;\n        var dy2 = p2.y - p3.y;\n        var m1 = { x: (p1.x + p2.x) / 2.0, y: (p1.y + p2.y) / 2.0 };\n        var m2 = { x: (p2.x + p3.x) / 2.0, y: (p2.y + p3.y) / 2.0 };\n        var l1 = Math.sqrt(dx1 * dx1 + dy1 * dy1);\n        var l2 = Math.sqrt(dx2 * dx2 + dy2 * dy2);\n        var dxm = (m1.x - m2.x);\n        var dym = (m1.y - m2.y);\n        var k = l2 / (l1 + l2);\n        var cm = { x: m2.x + dxm * k, y: m2.y + dym * k };\n        var tx = p2.x - cm.x;\n        var ty = p2.y - cm.y;\n        return {\n            controlPoint1: this.point(m1.x + tx, m1.y + ty, 0),\n            controlPoint2: this.point(m2.x + tx, m2.y + ty, 0)\n        };\n    };\n    /* Returns approximated bezier length of the curuve.*/\n    SignatureBase.prototype.bezierLengthCalc = function () {\n        var steps = 10;\n        var length = 0;\n        var i;\n        var t;\n        var pointx1;\n        var pointy1;\n        var pointx2;\n        var pointy2;\n        var pointx3;\n        var pointy3;\n        for (i = 0; i <= steps; i++) {\n            t = i / steps;\n            pointx1 = this.bezierPointCalc(t, this.startPoint.x, this.controlPoint1.x, this.controlPoint2.x, this.endPoint.x);\n            pointy1 = this.bezierPointCalc(t, this.startPoint.y, this.controlPoint1.y, this.controlPoint2.y, this.endPoint.y);\n            if (i > 0) {\n                pointx3 = pointx1 - pointx2;\n                pointy3 = pointy1 - pointy2;\n                length += Math.sqrt(pointx3 * pointx3 + pointy3 * pointy3);\n            }\n            pointx2 = pointx1;\n            pointy2 = pointy1;\n        }\n        return length;\n    };\n    /* Calculate parametric value of x or y given t and the\n       four point(startpoint, controlpoint1, controlpoint2, endpoint) coordinates of a cubic bezier curve.*/\n    SignatureBase.prototype.bezierPointCalc = function (t, startpoint, cp1, cp2, endpoint) {\n        return startpoint * (1.0 - t) * (1.0 - t) * (1.0 - t) + 3.0 * cp1 * (1.0 - t) * (1.0 - t) * t + 3.0 *\n            cp2 * (1.0 - t) * t * t + endpoint * t * t * t;\n    };\n    /* Velocity between the current point and last point.*/\n    SignatureBase.prototype.pointVelocityCalc = function (startPoint) {\n        return (this.time !== startPoint.time) ? this.distanceTo(startPoint) / (this.time - startPoint.time) : 0;\n    };\n    /* Distance between the current point and last point.*/\n    SignatureBase.prototype.distanceTo = function (start) {\n        return Math.sqrt(Math.pow(this.pointX - start.x, 2) + Math.pow(this.pointY - start.y, 2));\n    };\n    SignatureBase.prototype.isRead = function (isRead) {\n        if (isRead) {\n            EventHandler.remove(this.canvasContext.canvas, 'mousedown touchstart', this.mouseDownHandler);\n        }\n        else if (!this.disabled) {\n            EventHandler.add(this.canvasContext.canvas, 'mousedown touchstart', this.mouseDownHandler, this);\n        }\n    };\n    SignatureBase.prototype.enableOrDisable = function (isDisable) {\n        this.disabled = isDisable;\n        if (isDisable) {\n            this.reDraw('0.5');\n            this.isRead(true);\n        }\n        else {\n            this.reDraw('1');\n            this.isRead(false);\n        }\n    };\n    SignatureBase.prototype.reDraw = function (opacity) {\n        var data = this.canvasContext.getImageData(0, 0, this.element.width, this.element.height);\n        this.canvasContext.clearRect(0, 0, this.element.width, this.element.height);\n        this.element.style.opacity = opacity;\n        this.canvasContext.putImageData(data, 0, 0);\n    };\n    SignatureBase.prototype.updateSnapCollection = function (isClear) {\n        if (isNullOrUndefined(this.incStep)) {\n            this.incStep = -1;\n            this.incStep++;\n            this.snapColl = [];\n            this.clearArray = [];\n        }\n        else {\n            this.incStep++;\n        }\n        if (this.incStep < this.snapColl.length) {\n            this.snapColl.length = this.incStep;\n        }\n        if (this.incStep > 0) {\n            var canvasNew = this.createElement('canvas', { className: 'e-' + this.getModuleName() + '-wrapper' });\n            var canvasContextNew = canvasNew.getContext('2d');\n            canvasNew.width = this.canvasContext.canvas.width;\n            canvasNew.height = this.canvasContext.canvas.height;\n            canvasContextNew.drawImage(this.canvasContext.canvas, 0, 0, canvasNew.width, canvasNew.height);\n            this.snapColl.push(canvasNew.toDataURL());\n        }\n        else {\n            this.snapColl.push(this.canvasContext.canvas.toDataURL());\n        }\n        if (isClear) {\n            this.clearArray.push(this.incStep);\n        }\n    };\n    SignatureBase.prototype.setBackgroundImage = function (imageSrc) {\n        // eslint-disable-next-line @typescript-eslint/no-this-alias\n        var proxy = this;\n        var imageObj = new Image();\n        imageObj.crossOrigin = 'anonymous';\n        imageObj.src = imageSrc;\n        imageObj.onload = function () {\n            proxy.canvasContext.globalCompositeOperation = 'source-over';\n            proxy.canvasContext.drawImage(imageObj, 0, 0, proxy.element.width, proxy.element.height);\n            proxy.updateSnapCollection();\n            proxy.saveBackground(true);\n        };\n        this.canvasContext.clearRect(0, 0, this.canvasContext.canvas.width, this.canvasContext.canvas.height);\n    };\n    SignatureBase.prototype.setBackgroundColor = function (color) {\n        var canvasEle = this.canvasContext;\n        canvasEle.strokeStyle = color;\n        var i;\n        var j;\n        for (i = 1; i <= canvasEle.canvas.width; i++) {\n            for (j = 1; j <= canvasEle.canvas.height; j++) {\n                canvasEle.strokeRect(0, 0, i, j);\n            }\n        }\n        this.updateSnapCollection();\n    };\n    SignatureBase.prototype.loadPersistedSignature = function () {\n        if (isNullOrUndefined(this.signatureValue)) {\n            return;\n        }\n        // eslint-disable-next-line @typescript-eslint/no-this-alias\n        var proxy = this;\n        var lastImage = new Image();\n        lastImage.src = this.signatureValue;\n        lastImage.onload = function () {\n            proxy.canvasContext.clearRect(0, 0, proxy.element.width, proxy.element.height);\n            proxy.canvasContext.drawImage(lastImage, 0, 0);\n            proxy.updateSnapCollection();\n        };\n        this.isSignatureEmpty = false;\n    };\n    /**\n     * To get the signature as Blob.\n     *\n     * @param {string} url - specify the url/base 64 string to get blob of the signature.\n     * @returns {Blob}.\n     */\n    SignatureBase.prototype.getBlob = function (url) {\n        var arr = url.split(',');\n        var type = arr[0].match(/:(.*?);/)[1];\n        var bstr = atob(arr[1]);\n        var n = bstr.length;\n        var u8arr = new Uint8Array(n);\n        while (n--) {\n            u8arr[n] = bstr.charCodeAt(n);\n        }\n        return new Blob([u8arr], { type: type });\n    };\n    SignatureBase.prototype.download = function (blob, fileName) {\n        var blobUrl = URL.createObjectURL(blob);\n        var a = document.createElement('a');\n        a.href = blobUrl;\n        a.target = '_parent';\n        a.download = fileName;\n        (document.body || document.documentElement).appendChild(a);\n        a.click();\n        a.parentNode.removeChild(a);\n    };\n    /**\n     * To refresh the signature.\n     *\n     * @private\n     * @returns {void}.\n     */\n    SignatureBase.prototype.refresh = function () {\n        this.pointColl = [];\n        this.lastVelocity = 0;\n        this.lastWidth = (this.minStrokeWidth + this.maxStrokeWidth) / 2;\n    };\n    /**\n     * Erases all the signature strokes signed by user.\n     *\n     * @returns {void}.\n     */\n    SignatureBase.prototype.clear = function () {\n        var args = { actionName: 'clear' };\n        this.canvasContext.clearRect(0, 0, this.canvasContext.canvas.width, this.canvasContext.canvas.height);\n        this.refresh();\n        this.updateSnapCollection(true);\n        this.isSignatureEmpty = true;\n        if (!this.isBlazor) {\n            this.trigger('change', args);\n        }\n        else {\n            this.dotnetRef.invokeMethodAsync('TriggerEventAsync', 'Clear');\n        }\n    };\n    /**\n     * Undo the last user action.\n     *\n     * @returns {void}.\n     */\n    SignatureBase.prototype.undo = function () {\n        var args = { actionName: 'undo' };\n        // eslint-disable-next-line @typescript-eslint/no-this-alias\n        var proxy = this;\n        if (this.incStep > 0) {\n            this.incStep--;\n            var undoImg_1 = new Image();\n            undoImg_1.src = this.snapColl[this.incStep];\n            undoImg_1.onload = function () {\n                proxy.canvasContext.clearRect(0, 0, proxy.element.width, proxy.element.height);\n                proxy.canvasContext.drawImage(undoImg_1, 0, 0, proxy.element.width, proxy.element.height);\n            };\n        }\n        this.isClear();\n        if (!this.isBlazor) {\n            this.trigger('change', args);\n        }\n        else {\n            this.dotnetRef.invokeMethodAsync('TriggerEventAsync', 'Undo');\n        }\n    };\n    /**\n     * Redo the last user action.\n     *\n     * @returns {void}.\n     */\n    SignatureBase.prototype.redo = function () {\n        var args = { actionName: 'redo' };\n        // eslint-disable-next-line @typescript-eslint/no-this-alias\n        var proxy = this;\n        if (this.incStep < this.snapColl.length - 1) {\n            this.incStep++;\n            var redoImg_1 = new Image();\n            redoImg_1.src = this.snapColl[this.incStep];\n            redoImg_1.onload = function () {\n                proxy.canvasContext.clearRect(0, 0, proxy.element.width, proxy.element.height);\n                proxy.canvasContext.drawImage(redoImg_1, 0, 0, proxy.element.width, proxy.element.height);\n            };\n        }\n        this.isClear();\n        if (!this.isBlazor) {\n            this.trigger('change', args);\n        }\n        else {\n            this.dotnetRef.invokeMethodAsync('TriggerEventAsync', 'Redo');\n        }\n    };\n    SignatureBase.prototype.isClear = function () {\n        if (this.clearArray) {\n            var empty = false;\n            for (var i = 0; i < this.clearArray.length; i++) {\n                if (this.clearArray[i] === this.incStep) {\n                    this.isSignatureEmpty = true;\n                    empty = true;\n                }\n            }\n            if (!empty) {\n                this.isSignatureEmpty = false;\n            }\n        }\n    };\n    /**\n     * To check whether the signature is empty or not.\n     *\n     * @returns {boolean}.\n     */\n    SignatureBase.prototype.isEmpty = function () {\n        return this.isSignatureEmpty;\n    };\n    /**\n     * To check whether the undo collection is empty or not.\n     *\n     * @returns {boolean}.\n     */\n    SignatureBase.prototype.canUndo = function () {\n        return this.incStep > 0;\n    };\n    /**\n     * To check whether the redo collection is empty or not.\n     *\n     * @returns {boolean}.\n     */\n    SignatureBase.prototype.canRedo = function () {\n        return this.incStep < this.snapColl.length - 1;\n    };\n    /**\n     * To draw the signature based on the given text, with the font family and font size.\n     *\n     * @param {string} text - specify text to be drawn as signature.\n     * @param {string} fontFamily - specify font family of a signature.\n     * @param {number} fontSize - specify font size of a signature.\n     *\n     * @returns {void}.\n     */\n    SignatureBase.prototype.draw = function (text, fontFamily, fontSize) {\n        this.canvasContext.clearRect(0, 0, this.canvasContext.canvas.width, this.canvasContext.canvas.height);\n        fontFamily = fontFamily || 'Arial';\n        fontSize = fontSize || 30;\n        this.canvasContext.font = fontSize + 'px ' + fontFamily;\n        this.canvasContext.textAlign = 'center';\n        this.canvasContext.textBaseline = 'middle';\n        this.canvasContext.fillText(text, this.element.width / 2, this.element.height / 2);\n        this.updateSnapCollection();\n        this.isSignatureEmpty = false;\n    };\n    /**\n     * To load the signature with the given base 64 string, height and width.\n     *\n     * @param {string} signature - specify the url/base 64 string to be drawn as signature.\n     * @param {number} width - specify the width of the loaded signature image.\n     * @param {number} height - specify the height of the loaded signature image.\n     * @returns {void}.\n     */\n    SignatureBase.prototype.load = function (signature, width, height) {\n        height = height || this.element.height;\n        width = width || this.element.width;\n        this.canvasContext.clearRect(0, 0, this.canvasContext.canvas.width, this.canvasContext.canvas.height);\n        // eslint-disable-next-line @typescript-eslint/no-this-alias\n        var proxy = this;\n        var bitmapImage = new Image();\n        bitmapImage.src = signature;\n        if (signature.slice(0, 4) !== 'data') {\n            bitmapImage.crossOrigin = 'anonymous';\n        }\n        bitmapImage.onload = function () {\n            Promise.all([\n                createImageBitmap(bitmapImage, 0, 0, width, height)\n            ]).then(function (results) {\n                var tempCanvas = document.createElement('canvas');\n                tempCanvas.width = width;\n                tempCanvas.height = height;\n                tempCanvas.getContext('2d').drawImage(results[0], 0, 0);\n                if (signature.slice(0, 4) !== 'data') {\n                    proxy.canvasContext.globalCompositeOperation = 'source-over';\n                }\n                proxy.canvasContext.drawImage(tempCanvas, 0, 0, width, height, 0, 0, proxy.element.width, proxy.element.height);\n                proxy.updateSnapCollection();\n            });\n        };\n        this.isSignatureEmpty = false;\n    };\n    SignatureBase.prototype.saveBackground = function (savebg) {\n        var imageSrc;\n        if (savebg && this.backgroundImage) {\n            imageSrc = this.snapColl[this.incStep - 1];\n        }\n        else {\n            imageSrc = this.snapColl[this.incStep];\n        }\n        if (!savebg) {\n            this.canvasContext.clearRect(0, 0, this.canvasContext.canvas.width, this.canvasContext.canvas.height);\n            if (this.backgroundImage) {\n                this.setBackgroundImage(this.backgroundImage);\n            }\n            else if (this.backgroundColor) {\n                this.setBackgroundColor(this.backgroundColor);\n                savebg = true;\n            }\n        }\n        if (savebg) {\n            // eslint-disable-next-line @typescript-eslint/no-this-alias\n            var proxy_1 = this;\n            var imageObj_1 = new Image();\n            imageObj_1.crossOrigin = 'anonymous';\n            imageObj_1.src = imageSrc;\n            imageObj_1.onload = function () {\n                proxy_1.backgroundLoaded = true;\n                proxy_1.canvasContext.globalCompositeOperation = 'source-over';\n                proxy_1.canvasContext.drawImage(imageObj_1, 0, 0, proxy_1.element.width, proxy_1.element.height);\n                proxy_1.save(proxy_1.fileType, proxy_1.fileName);\n            };\n        }\n    };\n    /**\n     * To save the signature with the given file type and file name.\n     *\n     * @param {SignatureFileType} type - specify type of the file to be saved a signature.\n     * @param {string} fileName - specify name of the file to be saved a signature.\n     *\n     * @returns {void}.\n     */\n    SignatureBase.prototype.save = function (type, fileName) {\n        if (this.saveWithBackground && this.backgroundLoaded == null && (this.backgroundImage || this.backgroundColor)) {\n            this.backgroundLoaded = false;\n            this.fileType = type;\n            this.fileName = fileName;\n            this.saveBackground(false);\n        }\n        else if (type === 'Svg') {\n            fileName = fileName || 'Signature';\n            this.toSVG(fileName);\n        }\n        else if (type === 'Jpeg') {\n            fileName = fileName || 'Signature';\n            if (!this.saveWithBackground || this.saveWithBackground && !(this.backgroundImage || this.backgroundColor)) {\n                this.toJPEG(fileName);\n            }\n            else {\n                var dataURL = this.canvasContext.canvas.toDataURL('image/jpeg');\n                this.download(this.getBlob(dataURL), fileName + '.' + 'jpeg');\n            }\n        }\n        else {\n            fileName = fileName || 'Signature';\n            var dataURL = this.canvasContext.canvas.toDataURL('image/png');\n            this.download(this.getBlob(dataURL), fileName + '.' + 'png');\n        }\n        if (this.saveWithBackground && this.backgroundLoaded) {\n            this.resetSnap();\n        }\n    };\n    SignatureBase.prototype.resetSnap = function () {\n        this.canvasContext.clearRect(0, 0, this.canvasContext.canvas.width, this.canvasContext.canvas.height);\n        // eslint-disable-next-line @typescript-eslint/no-this-alias\n        var proxy = this;\n        var restoreObj = new Image();\n        restoreObj.src = this.snapColl[this.incStep - 1];\n        restoreObj.onload = function () {\n            proxy.canvasContext.drawImage(restoreObj, 0, 0, proxy.element.width, proxy.element.height);\n            proxy.updateSnapCollection();\n        };\n        this.backgroundLoaded = null;\n        this.snapColl.pop();\n        this.incStep--;\n        this.snapColl.pop();\n        this.incStep--;\n    };\n    SignatureBase.prototype.toJPEG = function (fileName) {\n        var _this = this;\n        var imageSrc = this.snapColl[this.incStep];\n        this.setBackgroundColor('#ffffff');\n        // eslint-disable-next-line @typescript-eslint/no-this-alias\n        var proxy = this;\n        var imageObj = new Image();\n        imageObj.crossOrigin = 'anonymous';\n        imageObj.src = imageSrc;\n        imageObj.onload = function () {\n            proxy.canvasContext.globalCompositeOperation = 'source-over';\n            proxy.canvasContext.drawImage(imageObj, 0, 0, proxy.element.width, proxy.element.height);\n            var dataURL = proxy.canvasContext.canvas.toDataURL('image/jpeg');\n            proxy.download(proxy.getBlob(dataURL), fileName + '.' + 'jpeg');\n            proxy.canvasContext.clearRect(0, 0, proxy.canvasContext.canvas.width, proxy.canvasContext.canvas.height);\n            _this.resizeHandler();\n        };\n        this.snapColl.pop();\n        this.incStep--;\n    };\n    SignatureBase.prototype.toSVG = function (fileName) {\n        var dataUrl = this.canvasContext.canvas.toDataURL();\n        var svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');\n        svg.setAttribute('width', this.canvasContext.canvas.width.toString());\n        svg.setAttribute('height', this.canvasContext.canvas.height.toString());\n        var XLinkNS = 'http://www.w3.org/1999/xlink';\n        var img = document.createElementNS('http://www.w3.org/2000/svg', 'image');\n        img.setAttributeNS(null, 'height', this.canvasContext.canvas.height.toString());\n        img.setAttributeNS(null, 'width', this.canvasContext.canvas.width.toString());\n        img.setAttributeNS(XLinkNS, 'xlink:href', dataUrl);\n        svg.appendChild(img);\n        var prefix = 'data:image/svg+xml;base64,';\n        var header = '<svg' + ' xmlns=\"http://www.w3.org/2000/svg\"' + ' xmlns:xlink=\"http://www.w3.org/1999/xlink\"'\n            + (\" width=\\\"\" + this.canvasContext.canvas.width + \"\\\"\") + (\" height=\\\"\" + this.canvasContext.canvas.height + \"\\\"\") + '>';\n        var footer = '</svg>';\n        var body = svg.innerHTML;\n        var data = header + body + footer;\n        var svgDataUrl = prefix + btoa(data);\n        if (fileName == null) {\n            return svgDataUrl;\n        }\n        else {\n            this.download(this.getBlob(svgDataUrl), fileName + '.' + 'svg');\n            return null;\n        }\n    };\n    /**\n     * To save the signature as Blob.\n     *\n     * @returns {Blob}.\n     */\n    SignatureBase.prototype.saveAsBlob = function () {\n        return this.getBlob(this.canvasContext.canvas.toDataURL('image/png'));\n    };\n    /**\n     * To get the signature as Base 64.\n     *\n     * @private\n     * @param {SignatureFileType} type - Specifies the type of the image format.\n     * @returns {string}.\n     */\n    SignatureBase.prototype.getSignature = function (type) {\n        if (type === 'Jpeg') {\n            var imgData = this.canvasContext.getImageData(0, 0, this.element.width, this.element.height);\n            var data = imgData.data;\n            for (var i = 0; i < data.length; i += 4) {\n                if (data[i + 3] < 255) {\n                    data[i] = 255 - data[i];\n                    data[i + 1] = 255 - data[i + 1];\n                    data[i + 2] = 255 - data[i + 2];\n                    data[i + 3] = 255 - data[i + 3];\n                }\n            }\n            this.canvasContext.putImageData(imgData, 0, 0);\n            var dataURL = this.canvasContext.canvas.toDataURL('image/jpeg');\n            this.resizeHandler();\n            return dataURL;\n        }\n        else if (type === 'Svg') {\n            return this.toSVG(null);\n        }\n        else {\n            return this.canvasContext.canvas.toDataURL('image/png');\n        }\n    };\n    /**\n     * Get component name.\n     *\n     * @returns {string} - Module Name\n     * @private\n     */\n    SignatureBase.prototype.getModuleName = function () {\n        return 'signature';\n    };\n    /**\n     * To get the properties to be maintained in the persisted state.\n     *\n     * @returns {string} - Persist data\n     */\n    SignatureBase.prototype.getPersistData = function () {\n        this.signatureValue = this.snapColl[this.incStep];\n        return this.addOnPersist(['signatureValue']);\n    };\n    /**\n     * Removes the component from the DOM and detaches all its related event handlers.\n     * Also it maintains the initial input element from the DOM.\n     *\n     * @method destroy\n     * @returns {void}\n     */\n    SignatureBase.prototype.destroy = function () {\n        if (this.getModuleName() !== 'image-editor') {\n            this.unwireEvents(null);\n            removeClass([this.element], 'e-' + this.getModuleName());\n            this.element.removeAttribute('tabindex');\n            this.pointColl = null;\n        }\n        _super.prototype.destroy.call(this);\n    };\n    /**\n     * Modified onPropertyChanged method for both blazor and EJ2 signature component.\n     *\n     * @private\n     * @param {string} key - Specifies the property, which changed.\n     * @param {string} value - Specifies the property value changed.\n     * @returns {void}\n     */\n    SignatureBase.prototype.propertyChanged = function (key, value) {\n        var canvasNew = this.canvasContext;\n        switch (key) {\n            case 'backgroundColor':\n                canvasNew.canvas.style.backgroundColor = value;\n                this.backgroundColor = value;\n                break;\n            case 'backgroundImage':\n                canvasNew.canvas.style.backgroundImage = 'url(' + value + ')';\n                this.backgroundImage = value;\n                break;\n            case 'strokeColor':\n                canvasNew.fillStyle = value;\n                this.strokeColor = value;\n                break;\n            case 'saveWithBackground':\n                this.saveWithBackground = value;\n                break;\n            case 'maxStrokeWidth':\n                this.maxStrokeWidth = value;\n                break;\n            case 'minStrokeWidth':\n                this.minStrokeWidth = value;\n                break;\n            case 'velocity':\n                this.velocity = value;\n                break;\n            case 'isReadOnly':\n                this.isRead(value);\n                break;\n            case 'disabled':\n                this.enableOrDisable(value);\n                break;\n        }\n    };\n    return SignatureBase;\n}(Component));\nexport { SignatureBase };\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}